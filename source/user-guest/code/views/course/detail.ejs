<style>
  .navbar-collapse {
    flex-grow: 0;
  }

  .navbar-collapse-right {
    margin-left: 750px;
  }

  .container-wrap {
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    padding-top: 48px;
  }

  .text-container {
    width: 100%;
    max-width: 1340px;
    margin-right: auto;
    margin-left: auto;
    padding: 20px 2.4px 30px 2.4px;
    border-bottom: 1px solid #dcdacb;
  }

  .heading-xl {
    font-family: sf pro display, -apple-system, BlinkMacSystemFont, Roboto,
      segoe ui, Helvetica, Arial, sans-serif, apple color emoji, segoe ui emoji,
      segoe ui symbol;
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.02px;
    font-size: 24px;
    margin-bottom: 20px;
  }

  .heading-lg {
    font-family: sf pro display, -apple-system, BlinkMacSystemFont, Roboto,
      segoe ui, Helvetica, Arial, sans-serif, apple color emoji, segoe ui emoji,
      segoe ui symbol;
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.2px;
    font-size: 20px;
  }

  .heading-md {
    font-family: sf pro display, -apple-system, BlinkMacSystemFont, Roboto,
      segoe ui, Helvetica, Arial, sans-serif, apple color emoji, segoe ui emoji,
      segoe ui symbol;
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.2px;
    font-size: 16px;
  }

  /* Updated header background to blue with white text */
  .black-background {
    padding-top: 48px;
    width: 100%;
    height: 430px;
    background-color: #1e40af;
    padding-top: 32px;
    padding-bottom: 32px;
    color: white;
  }

  .inlineblock {
    display: inline-block;
    width: 700px;
    height: 100%;
    padding: 5px;
  }

  .img {
    float: right;
    width: 450px;
    height: 300px;
  }

  .checked {
    color: orange;
  }

  .what-you-will-learn {
    background-color: #fbfbf8;
    border: 1px solid #dcdacb;
    border-radius: 4px;
    padding: 24px 0;
  }

  .what-you-will-learn-content {
    flex-flow: row wrap;
    justify-content: space-between;
  }

  .fas {
    font-size: 11px;
  }

  .teacher-avt {
    width: 110px;
    height: 110px;
  }

  .heading-xxl {
    font-weight: 700;
    font-size: 60px;
  }

  .card {
    width: 140px;
    align-items: center;
    border: 0;
  }

  .bar-container {
    width: 100%;
    background-color: #f1f1f1;
    text-align: center;
    color: white;
  }

  .middle {
    margin-top: 10px;
    float: left;
    width: 70%;
  }

  .bar {
    height: 13px;
    background-color: gray;
  }

  .bar-5 {
    width: 60%;
  }

  .bar-4 {
    width: 30%;
  }

  .bar-3 {
    width: 10%;
  }

  .bar-2 {
    width: 4%;
  }

  .bar-1 {
    width: 15%;
  }

  .col {
    padding-top: 17px;
  }

  .reviews {
    width: 50px;
    height: 50px;
    margin-right: 15px;
  }

  .container {
    max-width: 1220px;
  }

  .comment {
    padding-top: 40px;
  }

  .footer-container {
    padding-top: 30px;
    padding-bottom: 20px;
    font-size: 12px;
    text-align: center;
  }

  .pagination {
    padding-top: 30px;
  }

  .btn-outline-danger {
    margin-left: 10px;
  }
  .yellow-star {
    color: #fbbf24;
  }
  .red-heart {
    color: red;
  }
  .video {
    display: none;
  }

  .show-video {
    display: block;
  }
  .video-js{
      margin-left: 250px;
  }
  .row .info{
      margin-top: 10px;
      margin-left: -50px;
  }
  .student-response{
    margin-bottom: 20px;
  }
  .rating-star{
    margin-top: 20px;
  }
  .rating-star h3{
    margin-bottom: 10px;
  }
  .rating-star .star{
    margin-right: 30px;
    float: left;
    padding-top: 6px;
  }
  .rating-star .star .fa-star{
    font-size: 25px;
  }
  #evaluation label{
    margin-bottom: 10px;
    font-size: 20px;
  }
  #evaluation #review-btn{
    margin-top: 10px;
    padding: 10px 30px;
  }
  #student-feedback.text-container{
    border-bottom: 0px!important;
  }
  
</style>
<body>
  <!-- Updated header background to blue -->
  <div class="black-background">
    <div class="container-wrap">
      <div name="header">
        <img src="<%= course.poster %>" alt="image" class="img" />
        <div class="text-container inlineblock" style="border-bottom: 0">
          <div name="couser-detail">
            <h2
              id="nameCourse"
              data-name="<%= course.name%>"
              data-myEvaPoint="<%= myEvaluationPoint %>"
              data-evaPoint="<%= course.evaluationPoint %>"
              data-isWishCourse="<%= isWishCourse %>"
              data-isAuthenticated="<%= isAuthenticated%>"
              data-isPaid="<%= isPaid %>"
              data-id="<%= course._id %>"
            >
              <strong><%= course.name %></strong>
            </h2>
          </div>
          <p><%= course.description %></p>
          <!-- <i class="star0 fa fa-star"></i>
          <i class="star1 fa fa-star"></i>
          <i class="star2 fa fa-star"></i>
          <i class="star3 fa fa-star"></i>
          <i class="star4 fa fa-star"></i> -->
          <p><%= course.uploadDate.toDateString() %></p>
          <p>
            Gi·∫£ng vi√™n:
            <a href="#" style="color: rgb(144, 205, 247)">
              <strong><%= course.idLecturer.name %></strong>
            </a>
          </p>
          <% if (!isPaid) { %>
          <a href="/payment/<%= course.name %>/checkout">
            <!-- Updated purchase button to blue -->
            <button type="button" class="btn btn-primary">
              <i class="fas fa-wallet"></i>
              <strong style="font-size: 18px">Mua lu√¥n</strong>
            </button>
          </a>

          <% } %>
          <button id="wish-list" type="button" class="btn btn-outline-light">
            <i id="heart" class="fa fa-heart"></i>
            <strong style="font-size: 18px">Y√™u th√≠ch</strong>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="container-wrap">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item home-tab">
        <a
          class="nav-link active"
          id="intro-tab"
          data-toggle="tab"
          href="#couser-intro"
          role="tab"
          aria-controls="intro"
          aria-selected="true"
          style="font-size: 20px"
          >Gi·ªõi thi·ªáu</a
        >
      </li>
    </ul>

    <div id="couser-intro" class="text-container">
      <h2 class="heading-xl">V·ªÅ chuy√™n m√¥n</h2>
      <p> <%= course.expertise %> </p>
      <div class="what-you-will-learn">
        <h3 style="margin: 0 2.4rem 1.6rem">
          <strong>B·∫°n s·∫Ω ƒë∆∞·ª£c h·ªçc</strong>
        </h3>
        <ul class="what-you-will-learn-content">
          <% for( let i = 0; i < course.whatYoullLearn.length; i++ ) { %>
          <i class="fas fa-check"></i>
          <span> <%= course.whatYoullLearn[i] %> </span
          ><br />
          <% } %>
        </ul>
      </div>
    </div>

    <div id="couser-content" class="text-container">
      <h2 class="heading-xl">Gi√°o tr√¨nh c·ªßa kh√≥a h·ªçc nh∆∞ sau:</h2>
      <div class="document">
        <% course.videos.forEach((v, i) => { %>
        <div class="row align-items-center border-bottom py-2">
          <div class="col-sm-8">
            <ul class="m-0">
              <i class="fa fa-play-circle"></i>
              <span style="color: black"><%= i + 1 %>. <%= v.name %></span>
            </ul>
          </div>

          <div class="col-sm-4 text-end">
            <% if (isPaid) { %>
              <!-- ‚úÖ ƒê√£ mua: xem full -->
              <a href="/course/<%= course.name %>/watch/<%= i %>" class="btn btn-outline-success btn-sm">
                ‚ñ∂ Xem video
              </a>
            <% } else { %>
              <!-- ‚ùå Ch∆∞a mua: ch·ªâ xem ƒë∆∞·ª£c 1 video demo -->
              <% if (i === course.previewIndex[0]) { %>
                <a href="/course/<%= course.name %>/watch/<%= i %>" class="btn btn-outline-primary btn-sm">
                  üëÅ Xem th·ª≠
                </a>
              <% } else { %>
                <button class="btn btn-outline-secondary btn-sm" disabled>
                  üîí Mua kh√≥a h·ªçc ƒë·ªÉ xem
                </button>
              <% } %>
            <% } %>
          </div>
        </div>
        <% }) %>
      </div>

    <div id="course-teacher" class="container my-5 p-4 bg-light rounded shadow-sm">
      <h2 class="mb-4">Instructor</h2>

      <div class="row align-items-center">
        <!-- Avatar -->
        <div class="col-md-2 text-center mb-3 mb-md-0">
          <img src="<%= course.idLecturer.avatar %>" alt="Instructor Avatar" 
              class="img-fluid rounded-circle border border-primary" style="width: 100px; height: 100px; object-fit: cover;">
        </div>

        <!-- Info -->
        <div class="col-md-10">
          <h4>
            <a href="#" class="text-primary text-decoration-none">
              <%= course.idLecturer.name %>
            </a>
          </h4>
          <p class="mt-2 text-muted">
            <%= course.idLecturer.description %>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- B·∫•m n√∫t comment -->
  <script type="text/javascript">
  $("#review-btn").on("click", () => {
    const nameCourse = $("#nameCourse").attr("data-name");
    const review = $("#review").val();
    console.log(review);
    const data = {
      review: review,
    };
    $.post(`/course/${nameCourse}/review`, data);
    window.location.reload();
  });
  </script>
  <script>
  //B·∫•m v√†o ng√¥i sao th·ª© 4
  $("#eva-star4").on("click", () => {
    console.log("4");
    $("#eva-star4").addClass("yellow-star");
    $("#eva-star3").addClass("yellow-star");
    $("#eva-star2").addClass("yellow-star");
    $("#eva-star1").addClass("yellow-star");
    $("#eva-star0").addClass("yellow-star");
  });
  //B·∫•m v√†o ng√¥i sao th·ª© 3
  $("#eva-star3").on("click", () => {
    console.log("3");
    $("#eva-star4").removeClass("yellow-star");
    $("#eva-star3").addClass("yellow-star");
    $("#eva-star2").addClass("yellow-star");
    $("#eva-star1").addClass("yellow-star");
    $("#eva-star0").addClass("yellow-star");
  });
  //B·∫•m v√†o ng√¥i sao th·ª© 2
  $("#eva-star2").on("click", () => {
    console.log("2");
    $("#eva-star4").removeClass("yellow-star");
    $("#eva-star3").removeClass("yellow-star");
    $("#eva-star2").addClass("yellow-star");
    $("#eva-star1").addClass("yellow-star");
    $("#eva-star0").addClass("yellow-star");
  });
  //B·∫•m v√†o ng√¥i sao th·ª© 1
  $("#eva-star1").on("click", () => {
    console.log("1");
    $("#eva-star4").removeClass("yellow-star");
    $("#eva-star3").removeClass("yellow-star");
    $("#eva-star2").removeClass("yellow-star");
    $("#eva-star1").addClass("yellow-star");
    $("#eva-star0").addClass("yellow-star");
  });
  //B·∫•m v√†o ng√¥i sao th·ª© 0
  $("#eva-star0").on("click", () => {
    console.log("0");
    $("#eva-star4").removeClass("yellow-star");
    $("#eva-star3").removeClass("yellow-star");
    $("#eva-star2").removeClass("yellow-star");
    $("#eva-star1").removeClass("yellow-star");
    $("#eva-star0").addClass("yellow-star");
  });
  //B·∫•m g·ª≠i ƒë√°nh gi√°
  $("#eva-btn").on("click", () => {
    const isAuthenticated = $("#nameCourse").attr("data-isAuthenticated");
    const nameCourse = $("#nameCourse").attr("data-name");

    if (isAuthenticated == "true") {
      const isPaid = $("#eva-btn").attr("data-isPaid");
      if (isPaid == "true") {
        if ($("#eva-star4").hasClass("yellow-star")) {
          const data = {
            evaluationPoint: 5,
          };
          $.post(`/course/${nameCourse}/evaluate`, data, (json) => {
            if (json == true) {
              alert("B·∫°n ƒë√£ g·ª≠i ƒë√°nh gi√° th√†nh c√¥ng");
            } else {
              alert("R·∫•t ti·∫øc! ƒë√°nh gi√° c·ªßa b·∫°n kh√¥ng ƒë∆∞·ª£c ghi nh·∫≠n");
            }
          });
        } else if ($("#eva-star3").hasClass("yellow-star")) {
          const data = {
            evaluationPoint: 4,
          };
          $.post(`/course/${nameCourse}/evaluate`, data, (json) => {
            if (json == true) {
              alert("B·∫°n ƒë√£ g·ª≠i ƒë√°nh gi√° th√†nh c√¥ng");
            } else {
              alert("R·∫•t ti·∫øc! ƒë√°nh gi√° c·ªßa b·∫°n kh√¥ng ƒë∆∞·ª£c ghi nh·∫≠n");
            }
          });
        } else if ($("#eva-star2").hasClass("yellow-star")) {
          const data = {
            evaluationPoint: 3,
          };
          $.post(`/course/${nameCourse}/evaluate`, data, (json) => {
            if (json == true) {
              alert("B·∫°n ƒë√£ g·ª≠i ƒë√°nh gi√° th√†nh c√¥ng");
            } else {
              alert("R·∫•t ti·∫øc! ƒë√°nh gi√° c·ªßa b·∫°n kh√¥ng ƒë∆∞·ª£c ghi nh·∫≠n");
            }
          });
        } else if ($("#eva-star1").hasClass("yellow-star")) {
          const data = {
            evaluationPoint: 2,
          };
          $.post(`/course/${nameCourse}/evaluate`, data, (json) => {
            if (json == true) {
              alert("B·∫°n ƒë√£ g·ª≠i ƒë√°nh gi√° th√†nh c√¥ng");
            } else {
              alert("R·∫•t ti·∫øc! ƒë√°nh gi√° c·ªßa b·∫°n kh√¥ng ƒë∆∞·ª£c ghi nh·∫≠n");
            }
          });
        } else if ($("#eva-star0").hasClass("yellow-star")) {
          const data = {
            evaluationPoint: 1,
          };
          $.post(`/course/${nameCourse}/evaluate`, data, (json) => {
            if (json == true) {
              alert("B·∫°n ƒë√£ g·ª≠i ƒë√°nh gi√° th√†nh c√¥ng");
            } else {
              alert("R·∫•t ti·∫øc! ƒë√°nh gi√° c·ªßa b·∫°n kh√¥ng ƒë∆∞·ª£c ghi nh·∫≠n");
            }
          });
        }
        window.location.reload(true);
      } else {
        alert("B·∫°n h√£y mua kh√≥a h·ªçc tr∆∞·ªõc khi ƒë√°nh gi√°");
        window.location.replace(`/payment/${nameCourse}/checkout`);
      }
    } else {
      window.location.replace("/users/login");
    }
  });
  </script>
  <script>
    //B·∫•m v√†o hi·ªán video
    $(".btn-playVideo")
      .on("click", (e) => {
        console.log("hello");
        //M·ªü t·∫Øt video
        $(e.target).parent().siblings("video").toggleClass("show-video");
        const isPaid = $("#nameCourse").attr("data-isPaid");

        //C·∫≠p nh·∫≠t th√¥ng tin learnedVideo
        console.log($(e.target).attr("data-isLearned"));
        if ($(e.target).attr("data-isLearned") == "false" && isPaid == "true") {
          const nameCourse = $("#nameCourse").attr("data-name");
          const videoIndex = $(e.target).attr("data-index");

          const data = {
            videoIndex: videoIndex,
          };
          $.post(`/users/${nameCourse}/updateLearnedVideo`, data, (json) => {
            console.log("json: ", json);
            if (json == true) {
              $(e.target).attr("data-isLearned", "true");
              console.log("C·∫≠p nh·∫≠t l·ªãch s·ª≠ h·ªçc th√†nh c√¥ng");
            }
          });
        }
      });
  </script>
  <script>
    //B·∫•m v√†o n√∫t Y√™u th√≠ch
    $("#wish-list").on("click", (e) => {
      //ƒê·ªïi m√†u button
      $("#wish-list").children("i").toggleClass("red-heart");

      //Ki·ªÉm tra ƒë√£ ƒëƒÉng nh·∫≠p ch∆∞a
      const isAuthenticated = $("#nameCourse").attr("data-isAuthenticated");
      console.log(isAuthenticated);
      if (isAuthenticated == "true") {
        //D√πng ajax g·ª≠i th√¥ng tin v·ªÅ cho server thay ƒë·ªïi danh s√°ch y√™u th√≠ch
        const courseID = $("#nameCourse").attr("data-id");
        const data = {
          courseID: courseID,
        };
        $.post("/users/wish-list-change", data);
      } else {
        //ƒëi·ªÅu h∆∞·ªõng sang trang ƒëƒÉng nh·∫≠p
        location.replace("/users/login");
      }
    });
  </script>
  <script>
    $("document").ready(() => {
      //ƒê√°nh d·∫•u tr√°i tim ƒë·ªè
      const isWishCourse = $("#nameCourse").attr("data-isWishCourse");
      if (isWishCourse == "true") {
        $("#heart").addClass("red-heart");
      }
      //ƒê√°nh d·∫•u sao v√†ng d·ª±a v√†o ƒë√°nh gi√° chung
      let evaPoint = +$("#nameCourse").attr("data-evaPoint");
      evaPoint = evaPoint.toFixed(1);
      if (evaPoint >= 5) {
        $(".star0").addClass("yellow-star");
        $(".star1").addClass("yellow-star");
        $(".star2").addClass("yellow-star");
        $(".star3").addClass("yellow-star");
        $(".star4").addClass("yellow-star");
      } else if (evaPoint >= 4) {
        $(".star0").addClass("yellow-star");
        $(".star1").addClass("yellow-star");
        $(".star2").addClass("yellow-star");
        $(".star3").addClass("yellow-star");
      } else if (evaPoint >= 3) {
        $(".star0").addClass("yellow-star");
        $(".star1").addClass("yellow-star");
        $(".star2").addClass("yellow-star");
      } else if (evaPoint >= 2) {
        $(".star0").addClass("yellow-star");
        $(".star1").addClass("yellow-star");
      } else if (evaPoint >= 1) {
        $(".star0").addClass("yellow-star");
      }

      //ƒê√°nh d·∫•u sao v√†ng d·ª±a v√†o ƒë√°nh gi√° c·ªßa t√¥i
      let myEvaPoint = +$("#nameCourse").attr("data-myEvaPoint");
      myEvaPoint = myEvaPoint.toFixed(1);
      if (myEvaPoint >= 5) {
        $(".my-star0").addClass("yellow-star");
        $(".my-star1").addClass("yellow-star");
        $(".my-star2").addClass("yellow-star");
        $(".my-star3").addClass("yellow-star");
        $(".my-star4").addClass("yellow-star");
      } else if (myEvaPoint >= 4) {
        $(".my-star0").addClass("yellow-star");
        $(".my-star1").addClass("yellow-star");
        $(".my-star2").addClass("yellow-star");
        $(".my-star3").addClass("yellow-star");
      } else if (myEvaPoint >= 3) {
        $(".my-star0").addClass("yellow-star");
        $(".my-star1").addClass("yellow-star");
        $(".my-star2").addClass("yellow-star");
      } else if (myEvaPoint >= 2) {
        $(".my-star0").addClass("yellow-star");
        $(".my-star1").addClass("yellow-star");
      } else if (myEvaPoint >= 1) {
        $(".my-star0").addClass("yellow-star");
      }
    });
  </script>
</body>
